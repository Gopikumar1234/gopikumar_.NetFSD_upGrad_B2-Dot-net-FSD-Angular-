<!DOCTYPE html>
<html>
<head>
    <title>Mini Expense Tracker</title>
    <style>
        body {
            font-family: Arial;
            padding: 20px;
        }
        input, button {
            margin: 5px;
            padding: 8px;
        }
        table {
            border-collapse: collapse;
            width: 100%;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid black;
            padding: 8px;
            text-align: center;
        }
    </style>
</head>
<body>

    <h2>Mini Expense Tracker</h2>

    <!-- Input Fields -->
    <input type="text" id="title" placeholder="Expense Title">
    <input type="number" id="amount" placeholder="Amount">
    <input type="date" id="date">

    <br>

    <!-- Buttons -->
    <button onclick="addExpense()">Add Expense</button>
    <button onclick="viewExpenses()">View Expenses</button>

    <!-- Expense Table -->
    <table id="expenseTable">
        <thead>
            <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Amount</th>
                <th>Date</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

<script>
    // 1️⃣ Open Database
    var db = openDatabase('ExpenseDB', '1.0', 'Expense Database', 2 * 1024 * 1024);

    // 2️⃣ Create Table
    db.transaction(function(tx) {
        tx.executeSql(
            'CREATE TABLE IF NOT EXISTS expenses (id INTEGER PRIMARY KEY AUTOINCREMENT, title TEXT, amount REAL, date TEXT)',
            [],
            function() {
                console.log("Table created successfully");
            },
            function(tx, error) {
                alert("Table creation failed: " + error.message);
            }
        );
    });

    // 3️⃣ Add Expense
    function addExpense() {
        var title = document.getElementById("title").value;
        var amount = document.getElementById("amount").value;
        var date = document.getElementById("date").value;

        if (title === "" || amount === "" || date === "") {
            alert("Please fill all fields");
            return;
        }

        db.transaction(function(tx) {
            tx.executeSql(
                'INSERT INTO expenses (title, amount, date) VALUES (?, ?, ?)',
                [title, amount, date],
                function() {
                    alert("Expense added successfully");
                    viewExpenses();
                },
                function(tx, error) {
                    alert("Insert failed: " + error.message);
                }
            );
        });
    }

    // 4️⃣ View Expenses
    function viewExpenses() {
        db.transaction(function(tx) {
            tx.executeSql(
                'SELECT * FROM expenses',
                [],
                function(tx, results) {
                    var tbody = document.querySelector("#expenseTable tbody");
                    tbody.innerHTML = "";

                    for (var i = 0; i < results.rows.length; i++) {
                        var row = results.rows.item(i);

                        var tr = document.createElement("tr");

                        tr.innerHTML = `
                            <td>${row.id}</td>
                            <td>${row.title}</td>
                            <td>${row.amount}</td>
                            <td>${row.date}</td>
                            <td>
                                <button onclick="deleteExpense(${row.id})">
                                    Delete
                                </button>
                            </td>
                        `;

                        tbody.appendChild(tr);
                    }
                },
                function(tx, error) {
                    alert("Select failed: " + error.message);
                }
            );
        });
    }

    // 5️⃣ Delete Expense
    function deleteExpense(id) {
        db.transaction(function(tx) {
            tx.executeSql(
                'DELETE FROM expenses WHERE id = ?',
                [id],
                function() {
                    alert("Expense deleted");
                    viewExpenses();
                },
                function(tx, error) {
                    alert("Delete failed: " + error.message);
                }
            );
        });
    }

</script>

</body>
</html>